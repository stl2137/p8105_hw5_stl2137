---
title: "p8105_hw5_stl2137"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
```

```{r}
set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))
```

```{r}
fill_iris <- function(x) {
  if(is.character(x)) {
    replace(x, is.na(x), "virginica")
  } else if(is.numeric(x)) {
    replace(x, is.na(x), mean(x, na.rm = TRUE))
  }
}

filled_iris <- map_df(.x = iris_with_missing, ~fill_iris(.x))
```

## Problem 2

Create a tidy dataframe containing data from all participants, including the subject ID, arm, and observations over time:

Start with a dataframe containing all file names; the list.files function will help

Iterate over file names and read in data for each subject using purrr::map and saving the result as a new variable in the dataframe

Tidy the result; manipulate file names to include control arm and subject ID, make sure weekly observations are “tidy”, and do any other tidying that’s necessary

Make a spaghetti plot showing observations on each subject over time, and comment on differences between groups.

```{r}

long_study_total_list <- list.files(path = "./data", pattern = "*.csv") %>% 
  map_df(~ read_csv(file.path("./data",.))) %>% 
  pivot_longer(
    long_study_total_list,
    names_to = "week",
    names_prefix = "week_",
    values_to = "observation"
  )
  

```

## Problem 3

In this problem, you will conduct a simulation to explore power in a simple linear regression.

First set the following design elements:

Fix n=30
Fix xi1 as draws from a standard Normal distribution
Fix β0=2
Fix σ2=50
Set β1=0. Generate 10000 datasets from the model
yi=β0+β1xi1+ϵi
with ϵi∼N[0,σ2]. For each dataset, save β̂ 1 and the p-value arising from a test of H:β1=0 using α=0.05. Hint: to obtain the estimate and p-value, use broom::tidy to clean the output of lm.

```{r}

```

